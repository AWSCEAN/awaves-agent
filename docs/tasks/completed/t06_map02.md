## Task ID
t06_map02.md

## Status: COMPLETED

## Objective
Make corrections to map interaction features from t06_map01.md

## Issues Fixed

### 1. Map Click Handler
- Added native `mapboxgl.Popup` at clicked coordinates
- Shows surf score, safety score, wave height, wind speed, water temp for selected date
- Color coded: surf (green/yellow/red), safety (green/orange/red)
- Previous popup auto-closes on new click

### 2. Marker Positioning
- Fixed markers flying away on hover
- Used inner span element for scale transform instead of outer div
- Outer div no longer interferes with Mapbox CSS transform positioning

### 3. 10-Day Overlay Display
- Added regional overlay with color-coded circles across Korea
- Users can toggle between Surf Score and Safety Score views
- Overlay updates when selected date changes
- Grid of ~25 points generated across lat 33-39, lng 125-131

### 4. Wind Particles
- Replaced canvas-based WindParticles with Mapbox native `raster-particle` layer
- Uses `mapbox://rasterarrayexamples.gfs-winds` data source
- Particles render relative to earth, not screen
- Proper add/remove lifecycle on toggle

## Files Modified
- `apps/web/components/EnhancedMapboxMap.tsx` - All 4 fixes
- `apps/web/app/map/page.tsx` - Overlay toggle buttons, removed WindParticles canvas

## QA Results
- Bug 1: PASS
- Bug 2: PASS
- Bug 3: PASS
- Bug 4: PASS
- Build: PASS (0 errors)

## Completed: 2026-02-05
